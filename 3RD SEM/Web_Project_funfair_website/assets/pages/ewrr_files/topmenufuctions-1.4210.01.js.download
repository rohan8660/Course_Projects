var UserData; function switchLangBannerClose() { $("#lang-banner").hide() } $(window).load(function () { captcha_response = "", ($(".login-modal").is(":visible") || $("#signintab").is(":visible") || $(".login-box").is(":visible")) && (isRecaptchaEnabledLogon || captchaEnabledForgotPwd) && verifyCaptchaDiv("onCaptchaCallbackfrmheader") }), $(document).ready(function (s) { RenderUserInfo(), s("#btnCancelLogin,#btnok").click(function () { s("#log-in").removeClass("open") }), s("#btnok").click(function () { s("#frmsuccess").removeClass("show").addClass("hidden"), s("#frmsuccess").hide() }), s("#Email").keypress(DoSubmit), s("#inputPassword").keypress(DoSubmit), s("body").on("mouseenter", "#download-pack a:first-child", function () { objGTM1 = new GTM1, objGTM1.setValueswithCategory("Header Interactions", "Mouseover Help Icons", "DP Header Mouseover", "") }), s(".buyanotherdp").click(function () { objGTM1 = new GTM1, objGTM1.setValueswithCategory("Header Interactions", "Link Click", "Buy Another Download Pack", "") }), s(".snetwork").click(function () { objGTM1 = new GTM1, objGTM1.setValueswithCategory("Social Network Clicks", "Click - Footer", s(this).attr("id"), "") }), s(".snetwork-middle").click(function () { objGTM1 = new GTM1, objGTM1.setValueswithCategory("Social Network Clicks", "Click - Middle", s(this).attr("id"), "") }), s(".login-wrapper").on("contextmenu", function (e) { s(this).parent("li.dropdown").addClass("open") }), 0 < Errorflag.length && (s(".navbar-toggle").is(":visible") && s(".navbar-collapse").addClass("in"), 1 == Errorflag ? (s("#log-in").addClass("open"), s("#Email").val(showEmail), s("#inputPassword").val(""), s("#LblPwErrorMsg").text(headerMenuResources.TheEmailOrPasswordYouEnteredIsIncorrect), s("#LblPwErrorMsg").removeClass("hidden").addClass("show"), s("#LblPwErrorMsgDiv").addClass("has-error"), setTimeout(function () { s("#inputPassword").focus() }, 500), setTimeout(function () { s("#LblPwErrorMsg").removeClass("show").addClass("hidden"), s("#LblPwErrorMsgDiv").removeClass("has-error") }, 8e3), s("#Email").removeAttr("autofocus"), s("#inputPassword").focus()) : 2 == Errorflag ? (s("#log-in").addClass("open"), s("#Email").val(showEmail), s("#inputPassword").val(""), s("#LblPwErrorMsg").text(headerMenuResources.YourAccountHasBeenLockedBecauseOfMultipleFailedLoginAttempts), s("#LblPwErrorMsg").removeClass("hidden").addClass("show"), s("#LblPwErrorMsgDiv").addClass("has-error"), setTimeout(function () { s("#inputPassword").focus() }, 500), setTimeout(function () { s("#LblPwErrorMsg").removeClass("show").addClass("hidden"), s("#LblPwErrorMsgDiv").removeClass("has-error") }, 1e4), s("#Email").removeAttr("autofocus"), s("#inputPassword").focus()) : 3 == Errorflag ? (s("#log-in").addClass("open"), s("#Email").val(showEmail), s("#inputPassword").val(""), s("#LblPwErrorMsg").html(headerMenuResources.WereSorryWeCantLogYouInAtThisTime + "<a id='salesEmail' href='mailto:sales@alamy.com'>sales@alamy.com</a> " + headerMenuResources.OrTryAgainLater), s("#LblPwErrorMsg").removeClass("hidden").addClass("show"), s("#LblPwErrorMsgDiv").addClass("has-error"), setTimeout(function () { s("#inputPassword").focus() }, 500), setTimeout(function () { s("#LblPwErrorMsg").removeClass("show").addClass("hidden"), s("#LblPwErrorMsgDiv").removeClass("has-error") }, 1e4), s("#Email").removeAttr("autofocus"), s("#inputPassword").focus()) : 4 == Errorflag && (s("#log-in").addClass("open"), s(".login-wrapper.login-box").addClass("sa-error-dropdown-wrap"), s("#frmLogon").hide(), s("#forgotpassworddiv").removeClass("show").addClass("hidden"), s("#frmsuccess").removeClass("show").addClass("hidden"), s("#SaErrorDropdown").removeClass("hidden").addClass("show"), s("#SaErrorDropdown").show())), 0 < PWflag.length && (s(".navbar-toggle").is(":visible") && s(".navbar-collapse").addClass("in"), s("#log-in").addClass("open"), s("#frmLogon").hide(), s("#forgotpassworddiv").removeClass("show").addClass("hidden"), s("#frmsuccess").removeClass("hidden").addClass("show"), s("#frmsuccess").show(), s("#SuccesmsgDiv").removeClass("hidden").addClass("show"), s("#ShowSuccesmsg").val(showEmail)), s(".close-link").click(function () { s(".login-wrapper.login-box").removeClass("sa-error-dropdown-wrap"), s("#frmLogon").show(), s("#forgotpassworddiv").removeClass("show").addClass("hidden"), s("#frmsuccess").removeClass("show").addClass("hidden"), s("#SaErrorDropdown").removeClass("show").addClass("hidden") }), s("#linklogin").click(function () { (isRecaptchaEnabledLogon || captchaEnabledForgotPwd) && verifyCaptchaDiv("onCaptchaCallbackfrmheader"), s("#SaErrorDropdown").length && (s(".login-wrapper.login-box").removeClass("sa-error-dropdown-wrap"), s("#SaErrorDropdown").removeClass("show").addClass("hidden")), s("#frmsuccess").removeClass("show").addClass("hidden"), s("#frmsuccess").hide(), s("#inputPassword").val(""), s("#frmLogon").show(), s("#NewpasswordMSGDiv").removeClass("show").addClass("hidden"), s("#forgotpassworddiv").removeClass("show").addClass("hidden"), s("#Email").val(""), s("#Email").focus(), setTimeout(function () { s("#Email").focus() }, 1) }), s("#Moblogin").click(function () { (isRecaptchaEnabledLogon || captchaEnabledForgotPwd) && verifyCaptchaDiv("onCaptchaCallbackfrmheader") }), s("#ForgotPW").click(function () { (isRecaptchaEnabledLogon || captchaEnabledForgotPwd) && verifyCaptchaDiv("onCaptchaCallbackfrmheader"), s("#forgotpassworddiv").removeClass("hidden").addClass("show"), s("#frmLogon").hide(), s("#FpEmail").val(s("#Email").val()), s("#FpEmail").focus() }), s("#btnFPWCancelLogin").click(function () { s("#log-in").removeClass("open"), s("#frmLogon").show(), s("#forgotpassworddiv").removeClass("show").addClass("hidden"), s("#LblemailErrorMsg").removeClass("show").addClass("hidden") }), s("#btnFPWResetPassword").click(function () { ForgotPasswordSubmit() }), s("#forgotpassworddiv").submit(function (e) { ForgotPasswordSubmit(), e.preventDefault() }), s("body").click(function (e) { }), s("#linklogin").click(function () { var e = window.location.href.split(":"), a = getBrowserVersion(); if ((55 < a.chrome || 50 < a.firefox) && "https" != e[0]) { s(".nav .dropdown-menu,.sub-cont.non-mega ul,.login_arrow").hide(); var o = Hrefssl + "Logon.aspx?returnurl=" + encodeURIComponent(window.location.href); window.location.href = o } }), headerWidthCalc() }); var logoncap = 0, logonclk = 0; function CaptchaResponse() { return isRecaptchaEnabledLogon ? captcha_response : "" } function CaptchaResponsefp() { return captchaEnabledForgotPwd ? captcha_response : "" } function onCaptchaCallbackfrmheader(e) { captcha_response = e, $("body").css("", ""); var a = document.getElementById("frmLogon"); a.Captchahidden.value = e, 1 == logoncap ? (ValidateLogin(a), logoncap = 0) : ForgotPasswordSubmit() } function CaptchaExecutefromHeader() { return !isRecaptchaEnabledLogon || "" != captcha_response || (renderGoogleInvisibleRecaptcha("onCaptchaCallbackfrmheader"), $("body").css("overflow-x", "hidden"), !1) } function CaptchaExecuteforgotpassword() { return logoncap = 0, "" != captcha_response || !captchaEnabledForgotPwd || (renderGoogleInvisibleRecaptcha("onCaptchaCallbackfrmheader"), $("body").css("overflow-x", "hidden"), !1) } var headerWidthCalc = function () { $("nav.navbar .container").outerWidth() < 1e3 ? $("body").addClass("pageWithFixedContent") : $("body").addClass("pageWithFluidContent"), "de" == http_Culture && $("body").addClass("deutsch-body"), isInternational && $("body").addClass("bd-international") }, menutext = "", passwordexp = /^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[\W])(.{6,50})$/, emailexp = /^[\s]*[a-zA-Z_0-9][a-zA-Z_0-9\+\.\-\!\'&]{0,}@[a-zA-Z_0-9\.\-\!]+\.[a-zA-Z]{1,}[\s]*$/i, ForgotPasswordSubmit = function () { var e = $.trim($("#FpEmail").val()); 0 < e.length ? emailexp.test(e) ? CaptchaExecuteforgotpassword() && (window.location.href = securePath + "forgotten-pwdheader.asp?Email=" + encodeURIComponent(e) + "&cresponse=" + CaptchaResponsefp() + "&returnurl=" + returnHref.replace("deutsch", "")) : ($("#log-in").addClass("open"), $("#LblemailErrorMsg").text(headerMenuResources.PleaseEnterAValidEmailAddress), $("#LblemailErrorMsg").removeClass("hidden").addClass("show"), $("#LblemailErrorMsgDiv").addClass("has-error"), setTimeout(function () { $("#LblemailErrorMsg").removeClass("show").addClass("hidden"), $("#LblemailErrorMsgDiv").removeClass("has-error") }, 5e3), $("#FpEmail").focus()) : ($("#log-in").addClass("open"), $("#LblemailErrorMsg").text(headerMenuResources.YouHaveNotEnteredAnyEmailAddress), $("#LblemailErrorMsg").removeClass("hidden").addClass("show"), $("#LblemailErrorMsgDiv").addClass("has-error"), setTimeout(function () { $("#LblemailErrorMsg").removeClass("show").addClass("hidden"), $("#LblemailErrorMsgDiv").removeClass("has-error") }, 5e3), $("#FpEmail").focus()) }, ValidateLogin = function (e) { logoncap = 1; var a, o = document.cookie; if (document.cookie = "accept=true;Secure=true", null == GetCookie("accept")) return alert(headerMenuResources.ThisSiteRequiresCookiesPleaseSetYourBrowser), document.cookie = o, !1; if (document.cookie = o, !isValid(emailexp, e.email, !0, headerMenuResources.InvalidEmailAddress)) return e.email.focus(), !1; if (e.pwd.value.length < 6 || 50 < e.pwd.value.length) return $("#LblPwErrorMsg").text(headerMenuResources.InvalidPasswordPasswordmustBeBetween6And50Characters), $("#LblPwErrorMsg").removeClass("hidden").addClass("show"), $("#LblPwErrorMsgDiv").addClass("has-error"), setTimeout(function () { $("#LblPwErrorMsg").removeClass("show").addClass("hidden"), $("#LblPwErrorMsgDiv").removeClass("has-error") }, 5e3), e.pwd.focus(), !1; var s = ""; if (-1 < document.URL.indexOf("?") && -1 < document.URL.indexOf("logonheader.asp") ? (a = document.URL.split("?")[1], s = document.URL.substring(document.URL.indexOf("?") + 1)) : a = document.URL, -1 < e.action.toLowerCase().indexOf("imageresults.aspx") || -1 < e.action.toLowerCase().indexOf("videoresults.aspx")) { var r = alamy_search ? alamy_search._query.getQuery().encodeURL() : ""; -1 < e.action.indexOf(escape("?")) ? e.action = e.action.split(escape("?"))[0] + escape("?") + r : e.action = e.action + escape("?") + r, CaptchaExecutefromHeader() && e.submit() } else -1 < a.toLowerCase().indexOf("registration") || -1 < a.toLowerCase().indexOf("logonheader.asp") ? -1 < e.action.indexOf("?") && (e.action = e.action.split("?")[0] + "?frmHeader=1&returnurl=" + a, CaptchaExecutefromHeader() && e.submit()) : 0 < s.length ? -1 < e.action.indexOf("?") && (e.action = e.action.split("?")[0] + "?" + s, CaptchaExecutefromHeader() && e.submit()) : CaptchaExecutefromHeader() && e.submit(); return !0 }, isValid = function (e, a, o, s) { if (o && 0 == a.value.length) return $("#log-in").addClass("open"), $("#LblEmailMsg").text(headerMenuResources.InvalidEmailAddress1), $("#LblEmailMsg").removeClass("hidden").addClass("show"), $("#LblEmailMsgDiv").addClass("has-error"), setTimeout(function () { $("#LblEmailMsg").removeClass("show").addClass("hidden"), $("#LblEmailMsgDiv").removeClass("has-error") }, 5e3), !1; if (0 != a.value.length) { if ("alamyxh" == a.value) return !0; if (!e.test(a.value)) return $("#log-in").addClass("open"), $("#LblEmailMsg").text(headerMenuResources.InvalidEmailAddress1), $("#LblEmailMsg").removeClass("hidden").addClass("show"), $("#LblEmailMsgDiv").addClass("has-error"), $("#inputPassword").val(""), setTimeout(function () { $("#LblEmailMsg").removeClass("show").addClass("hidden"), $("#LblEmailMsgDiv").removeClass("has-error") }, 5e3), !1 } return !0 }; function GetCookie(e) { for (var a = document.cookie.split("; "), o = 0; o < a.length; o++) { var s = a[o].split("="); if (e == s[0]) return unescape(s[1]) } return null } var RenderUserInfo = function () { var e = (new Date).getTime(); $.ajax({ url: HrefPath + "Dataservice/DataserviceV2.aspx/GetUserMenuData", data: { internationalPage: isinternational_Page, rnd: e }, dataType: "json", type: "GET", contentType: "application/json; charset=utf-8", success: RenderUserInfoSuccess, fail: function () { } }) }, RenderUserInfoSuccess = function (e) { 1 == (UserData = e).d.LoggedIn ? ($("#signinmenu").css("display", "none"), $("#signedmenu").css("display", "block"), $("#divlogin").css("display", "none"), $("#itemParent").addClass("mt-25"), isshowpop = "True" == e.d.IsShowPopUp, 0 < e.d.FirstName.length ? 12 < e.d.FirstName.length ? $("#welcome").html(headerMenuResources.Hi + e.d.FirstName.substring(0, 12) + "...").attr("title", e.d.FirstName) : $("#welcome").html(headerMenuResources.Hi + e.d.FirstName) : 0 < e.d.Email.length && (12 < e.d.Email.length ? $("#welcome").html(headerMenuResources.Hi + e.d.Email.substring(0, 12) + "...").attr("title", e.d.Email) : $("#welcome").html(headerMenuResources.Hi + e.d.Email)), 0 != $("#hdShowpopup").length && (isshowpop ? $("#hdShowpopup").val("1") : $("#hdShowpopup").val("0"))) : ("0" != GetCookie("spu") && null != GetCookie("spu") && "null" != GetCookie("spu") ? $("#hdShowpopup").val("1") : $("#hdShowpopup").val("0"), $("#divlogin").css("display", "block"), $("#itemParent").removeClass("mt-25"), $("#signinmenu").css("display", "block")), $(".cartItems").html(e.d.CartItems); var a = "1"; (-1 == window.location.href.toLowerCase().indexOf("themes.aspx") && -1 == window.location.href.toLowerCase().indexOf("themes.asp") || ".alamy.de" != e.d.NativeDomain) && (-1 == window.location.href.toLowerCase().indexOf("contributors.aspx") || ".alamy.de" != e.d.NativeDomain && ".alamy.com" != e.d.NativeDomain) || (a = "0"), null != GetCookie("shbnr") && "" != GetCookie("shbnr") || "1" != a || "" == e.d.RedirectionBannerMessage || null == e.d.RedirectionBannerMessage || "" != http_referer && null != http_referer && /^(?:http(?:s)?:\/\/)?(?:[^\.]+\.)?(alamy.com|alamy.de|alamy.pt|alamy.es|alamy.it|alamy.uk|alamyimages.fr)(?:\/.*)?$/.test(http_referer) || ($("body").prepend("<div id='lang-banner' class='lang-switch-msg print-hide'><span id='automationLanguageBarText' class='lang-switch-text'>" + e.d.RedirectionBannerMessage + "</span><button onclick =\"LangSwitch( '" + e.d.NativeDomain + "');\" id ='lang-switch-btn'class='lang-switch-msg-btn'>" + e.d.NativeLanguage + "<span class='lang-switch-msg-btn-s'>›</span></button><i class='icon-close' onclick =\"switchLangBannerClose();\" id='bannerClose'></i></div>"), document.cookie = "shbnr=1; Secure=true; path=/"); var o, s = http_Or_Https_Path; s += "terms/general.aspx#Our-policy", o = "en" == http_Culture ? "alamy.com" : "fr" == http_Culture ? "alamyimages.fr" : "alamy." + http_Culture, null != GetCookie("yCookie") && "" != GetCookie("yCookie") || "0" != IsIntranet || ($("body").prepend('<div id="automationCookieBannerText" class="cookie-banner print-hide"><span>' + headerMenuResources.WeUseCookiesToGiveBetterExperience.replace("@@href@@", s).replace("@@siteName@@", o) + '<i id="automationCookiebannerClose" class="icon-close"></i></span></div>'), document.cookie = "yCookie=1; Secure=true; path=/"), $("body").on("click", ".cookie-banner .icon-close", function () { $(".cookie-banner").remove() }), RenderDownloadPackDetails(e), "undefined" != typeof EmailSubscriptionSuccess && $.isFunction(EmailSubscriptionSuccess) && EmailSubscriptionSuccess(UserData) }, RenderDownloadPackDetails = function (e) { var a = 0, o = !1, s = e.d; if (null != s.DownloadPacks && 0 < s.DownloadPacks.length && null != readCookie("AlamyUserID") && "" != readCookie("AlamyUserID")) { for (var r = "", n = 0; n < s.DownloadPacks.length; n++) { var t = s.DownloadPacks[n]; a += t.RemainingDownloads, r += '<tr><td id="automationPackageName' + (n + 1) + '">' + t.PackageName + '</td><td class="center" id="automationRemainingDownloads' + (n + 1) + '">' + t.RemainingDownloads + '</td><td id="automationRemainingDays' + (n + 1) + '">' + t.RemainingDays + "</td></tr>", 1 == t.ABTestPackPurchase && (o = !0) } $(".download-pack-history").html(r), $("body").addClass("download-pack"), $(".downloadPackItems").html(a), o ? ($("#automationBuyAnotherDownloadPack").attr("href", Href + "download-pack.aspx"), $(".buyanotherdp").attr("href", Href + "download-pack.aspx")) : ($("#automationBuyAnotherDownloadPack").attr("href", Href + "download-packs.aspx"), $(".buyanotherdp").attr("href", Href + "download-packs.aspx")) } }, DoSubmit = function (e) { if (!e.which && !e.keyCode) return !0; if (13 == e.which || 13 == e.keyCode) { var a = document.getElementById("frmLogon"); return ValidateLogin(a), !1 } }, LangSwitch = function (e) { var a; "undefined" == typeof ga || IsBotrequest || -1 == window.location.href.indexOf("_ga=") && ga(function () { var e = ga.getAll(); e.length && (a = e[0].get("linkerParam")) }); var o = ""; "" != a && null != a && (o = -1 != window.location.href.indexOf("?") ? "&" + a : "?" + a), objGTM = new GTM1; var s = cookieDomain.split(".")[2] + " - " + e.split(".")[2]; objGTM.setValueswithCategory("Language Selection", "Language Banner Click", s, ""); var r = " ", n = " "; ".alamy.com" == e || ".alamy.de" == e ? -1 != window.location.href.toLowerCase().indexOf("themes.aspx") ? (r = "themes.aspx", n = "themes.asp") : -1 != window.location.href.toLowerCase().indexOf("contactus.aspx") ? (r = "contactus.aspx", n = "contactus/uk.aspx") : -1 != window.location.href.toLowerCase().indexOf("terms/terms.aspx") ? (r = "terms/terms.aspx", n = "terms/uk.aspx") : -1 != window.location.href.toLowerCase().indexOf("contributors.aspx") && (r = "contributors.aspx", n = "default.aspx") : -1 != window.location.href.toLowerCase().indexOf("themes.asp") ? (r = "themes.asp", n = "themes.aspx") : -1 != window.location.href.toLowerCase().indexOf("contactus/") ? (r = window.location.href.substring(window.location.href.indexOf("contactus/"), window.location.href.length), n = "contactus.aspx") : -1 != window.location.href.toLowerCase().indexOf("terms/") && (r = window.location.href.substring(window.location.href.indexOf("terms/"), window.location.href.length), n = "terms/terms.aspx"), -1 != window.location.href.indexOf("/" + compurl_foldername + "-") ? window.location = "https://" + window.location.href.split("/")[2].replace(cookieDomain, e) + "/mediacomp/imagedetails.aspx?ref=" + compRequestParameters.imageRef + o.replace("?", "&") : ".alamy.com" == e && -1 != window.location.href.toLowerCase().indexOf("video-gallery.aspx") ? window.location = window.location.href.replace(cookieDomain, e).replace(r, n).replace("video-gallery.aspx", "footage-gallery.aspx") + o : ".alamy.de" == e && -1 != window.location.href.toLowerCase().indexOf("footage-gallery.aspx") ? window.location = window.location.href.replace(cookieDomain, e).replace(r, n).replace("footage-gallery.aspx", "video-gallery.aspx") + o : window.location = window.location.href.replace(cookieDomain, e).replace(r, n) + o }, RedirectClick = function () { LangSwitch(".alamy.com") }; function getBrowserVersion() { var e, a = navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./), o = navigator.userAgent.match(/Firefox\/([0-9]+)\./); return e = '{"chrome":' + (!!a && parseInt(a[2], 10)) + ',"firefox":' + (!!o && parseInt(o[1], 10)) + "}", JSON.parse(e) } var readCookie = function (e) { for (var a = e + "=", o = document.cookie.split(";"), s = 0; s < o.length; s++) { for (var r = o[s]; " " == r.charAt(0);)r = r.substring(1, r.length); if (0 == r.indexOf(a)) return r.substring(a.length, r.length) } return null }, setCaretPosition = function (e, a) { var o = document.getElementById(e); if (null != o) if (o.createTextRange) { var s = o.createTextRange(); s.move("character", a), s.select() } else o.selectionStart ? (o.focus(), o.setSelectionRange(a, a)) : o.focus() };